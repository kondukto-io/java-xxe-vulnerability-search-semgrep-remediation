{"errors": [], "paths": {"scanned": ["XXE/XXETestSSRF.class", "XXE/XXETestSSRF.java"]}, "results": [{"check_id": "contrib.owasp.java.xxe.documentbuilderfactory.owasp.java.xxe.javax.xml.parsers.DocumentBuilderFactory", "end": {"col": 92, "line": 18, "offset": 987}, "extra": {"engine_kind": "OSS", "fingerprint": "e876f91a9dec13d93a67b1d77e5257d23c27a9042ba4ea9aca39bb407fcd68197cf579bd3f8dca7a790b2fbd55769d4cc7cc6012fbb872068532ce1d1f272e31_0", "is_ignored": false, "lines": "            Document document = builder.parse(new ByteArrayInputStream(xmlData.getBytes()));", "message": "DocumentBuilderFactory being instantiated without calling the setFeature functions that are generally used for disabling entity processing, which can allow for XXE vulnerabilities", "metadata": {"category": "security", "confidence": "HIGH", "cwe": "CWE-611: Improper Restriction of XML External Entity Reference", "cwe2021-top25": true, "cwe2022-top25": true, "impact": "HIGH", "license": "Commons Clause License Condition v1.0[LGPL-2.1-only]", "likelihood": "LOW", "owasp": "A04:2017 - XML External Entities (XXE)", "references": ["https://www.programcreek.com/java-api-examples/?api=javax.xml.parsers.DocumentBuilderFactory"], "semgrep.dev": {"rule": {"origin": "community", "rule_id": "0oU5Dw", "url": "https://semgrep.dev/playground/r/PkTJZRq/contrib.owasp.java.xxe.documentbuilderfactory.owasp.java.xxe.javax.xml.parsers.DocumentBuilderFactory", "version_id": "PkTJZRq"}}, "shortlink": "https://sg.run/gLbR", "source": "https://semgrep.dev/r/contrib.owasp.java.xxe.documentbuilderfactory.owasp.java.xxe.javax.xml.parsers.DocumentBuilderFactory", "source-rule-url": "https://cheatsheetseries.owasp.org//cheatsheets/XML_External_Entity_Prevention_Cheat_Sheet.html", "subcategory": ["vuln"], "technology": ["java", "xml"], "vulnerability_class": ["XML Injection"]}, "metavars": {"$DB": {"abstract_content": "builder", "end": {"col": 40, "line": 18, "offset": 935}, "propagated_value": {"svalue_abstract_content": "factory.newDocumentBuilder()", "svalue_end": {"col": 67, "line": 17, "offset": 894}, "svalue_start": {"col": 39, "line": 17, "offset": 866}}, "start": {"col": 33, "line": 18, "offset": 928}}, "$DBF": {"abstract_content": "factory", "end": {"col": 46, "line": 17, "offset": 873}, "start": {"col": 39, "line": 17, "offset": 866}}}, "severity": "ERROR", "validation_state": "NO_VALIDATOR"}, "path": "XXE/XXETestSSRF.java", "start": {"col": 13, "line": 18, "offset": 908}}], "skipped_rules": [], "version": "1.42.0"}